DROP TABLE usuarios;

CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY, 
    cpf VARCHAR(11) UNIQUE NOT NULL,   
    saldo DECIMAL(10, 2) NOT NULL,
    saques DECIMAL(10,2) NOT NULL 
);

INSERT INTO usuarios (cpf, saldo, saques) 
VALUES
('12345678901', 1500.00, 1200.00),
('23456789012', 2000.00, 1800.00),
('34567890123', 1000.00, 800.00),
('45678901234', 1200.00, 950.00),
('56789012345', 800.00, 700.00),
('67890123456', 950.00, 100.00),
('78901234567', 3000.00, 2500.00),
('89012345678', 1500.00, 1000.00),
('90123456789', 500.00, 200.00),
('10234567890', 750.00, 300.00),
('21345678901', 1200.00, 900.00),
('32456789012', 1100.00, 850.00),
('43567890123', 1300.00, 1300.00),
('54678901234', 1800.00, 1000.00),
('65789012345', 900.00, 250.00),
('76890123456', 600.00, 500.00),
('87901234567', 2000.00, 1200.00),
('98012345678', 1600.00, 1250.00),
('11123456789', 1900.00, 1300.00),
('22234567890', 2500.00, 2000.00),
('33345678901', 2100.00, 2000.00),
('44456789012', 950.00, 300.00),
('55567890123', 700.00, 100.00),
('66678901234', 1800.00, 120.00),
('77789012345', 2300.00, 1000.00),
('88890123456', 1400.00, 400.00),
('99901234567', 500.00, 200.00),
('00012345678', 2200.00, 200.00),
('12123456789', 1700.00, 1000.00),
('23234567890', 1600.00, 800.00),
('34345678901', 1200.00, 600.00),
('45456789012', 1000.00, 300.00),
('56567890123', 800.00, 500.00);

SELECT COUNT(*) AS total_de_usuarios
FROM usuarios;

SELECT
SUM(saldo) AS soma_dos_saldos,
SUM(saques) AS soma_dos_saques
FROM usuarios;

SELECT cpf, saldo
FROM usuarios
ORDER BY saldo DESC;

SELECT saldo,
COUNT(id) AS quantidade_de_usuarios
FROM usuarios
GROUP BY saldo
ORDER BY quantidade_de_usuarios DESC;

SELECT saldo,
COUNT(id) AS numero_de_usuarios,
SUM(saques) AS total_sacado_pelo_grupo
FROM usuarios
GROUP BY saldo
HAVING COUNT(id) > 1 
ORDER BY saldo DESC; 
